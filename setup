#!/bin/sh

setup_packages() {
  # gets name of distro
  DISTRO="$(cat /etc/os-release | grep ^DISTRIB_ID | sed s/DISTRIB_ID=//g | sed s/\"//g)"
  # gets install command from distro and distro specific package names
  case "$DISTRO" in
    "void") 
      sudo xbps-install -Su
      # packages to install
      PACKAGES=
        "firefox"
        "font-awesome"
        "nerd-fonts"
        "neovim"
        "tmux"
        "zsh"
        "zsh-autosuggestions"
        "zsh-syntax-highlighting"
        "redshift"
        "curl"
        "base-devel"
        "xorg"
        "feh"
        "libX11-devel"
        "libXft-devel"
        "libXinerama-devel"
        "freetype-devel"
        "fontconfig-devel"
        "fzf"
        "bat"
      INSTALL_CMD="sudo xbps-install -S"
      ;;
    "arch") 
      INSTALL_CMD="sudo pacman -S"
      ;;
  esac
  for PACKAGE in ${PACKAGES[@]}; do
    eval "$INSTALL_CMD $PACKAGE" 
  done
}

setup_directories() {
  # makes the XDG dirs
  mkdir $HOME/.config
  mkdir $HOME/.local
  mkdir $HOME/.cache
  # make other home dirs
  mkdir $HOME/Pictures
  mkdir $HOME/Downloads
  # creating symlinks
  stow  $HOME/.dotfiles
}

setup_programs() {
  # ZSH
  sudo echo "export ZDOTDIR='$HOME/.config/zsh'" >> /etc/zsh/zshenv
  sudo chsh -s /usr/bin/zsh
  source $HOME/.config/zsh/.zshrc 
  # removing bash
  rm $HOME/.bash_history
  rm $HOME/.bash_logout
  rm $HOME/.bash_profile
  rm $HOME/.bashrc
  # tmux
  sudo git clone https://github.com/tmux-plugins/tpm $HOME/.config/tmux/plugins/tpm
  # neovim
  git clone --depth 1 https://github.com/wbthomason/packer.nvim\
   $HOME/.local/share/nvim/site/pack/packer/start/packer.nvim
  nvim --headless -c 'autocmd User PackerComplete quitall' -c 'PackerSync'
  # compiling suckless programs
  cd .local/share/dwm
  sudo make clean install
  cd ../dwmblocks
  sudo make clean install
  cd ../dmenu
  sudo make clean install
  cd  ../st
  sudo make clean install
}

setup() {
  setup_packages
  setup_directories
  setup_programs
}

setup
